<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
        <!-- Crear aviso: oportunidad con 5 dias sin accion         -->


        <!-- PERIODOS -->
        <!-- 5 dias -->
        <record id="warning_period_1" model="warning.period">
            <field name="name">5 dias</field>
            <field name="days">5</field>
            <field name="months">0</field>
            <field name="years">0</field>
        </record>
        <!-- 2 meses -->
        <record id="warning_period_2" model="warning.period">
            <field name="name">2 meses</field>
            <field name="days">0</field>
            <field name="months">2</field>
            <field name="years">0</field>
        </record>
        <!-- 3 dias -->
        <record id="warning_period_3" model="warning.period">
            <field name="name">3 dias</field>
            <field name="days">3</field>
            <field name="months">0</field>
            <field name="years">0</field>
        </record>

        <!-- CONDICIONES -->
        <!-- 3 dias sin modificacion -->
        <record id="warning_condition_1" model="warning.condition">
            <field name="name">Dias sin modificacion</field>
            <field name="period_id" ref="warning_period_3"/>
            <field name="amount">0</field>
        </record>
        <!-- Envio de presupuesto sin confirmacion en 5 dias -->
        <record id="warning_condition_2" model="warning.condition">
            <field name="name">Envio de presupuesto sin confirmacion</field>
            <field name="period_id" ref="warning_period_1"/>
            <field name="amount">0</field>
            <field name="state">sent</field>
        </record>
        <!-- Presupuesto cancelado + ingreso esperado superior a 100 -->
        <record id="warning_condition_3" model="warning.condition">
            <field name="name">Presupuesto cancelado + ingreso esperado superior a</field>
            <field name="amount">100</field>
            <field name="state">cancel</field>
        </record>
        
        <!-- ACCIONES -->
        <!-- Envio de mensaje de alerta a usuario -->
        <record id="warning_action_1" model="warning.action">
            <field name="name">Envio de mensaje de alerta a usuario</field>
            <field name="ttype">send_mess</field>
        </record>
        <!-- Programar llamada -->
        <record id="warning_action_2" model="warning.action">
            <field name="name">Programar llamada</field>
            <field name="ttype">create_call</field>
        </record>
        <!-- Programar reunion -->
        <record id="warning_action_3" model="warning.action">
            <field name="name">Programar reunion</field>
            <field name="ttype">create_meeting</field>
        </record>
        <!-- Crear oportunidad -->
        <record id="warning_action_4" model="warning.action">
            <field name="name">Crear oportunidad</field>
            <field name="ttype">create_opportunity</field>
        </record>

        <!-- AVISOS -->
        <!-- Aviso oportunidad sin modificacion desde hace X dias -->
        <record id="warning_messaging_1" model="warning.messaging">
            <field name="name">Aviso oportunidad sin modificacion</field>
            <field name="model_id" ref="crm.model_crm_lead"/>
            <field name="function_name">_check_lead_period</field>
            <field name="body">[AVISO] Han pasado X dias sin que la oportunidad se modifique.</field>
            <field name="condition_ids" eval="[(6,0,[ref('warning_messaging.warning_condition_1')])]"/>
            <field name="action_ids" eval="[(6,0,[ref('warning_messaging.warning_action_1')])]"/>
        </record>
        <!-- Aviso presupuesto sin respuesta -->
        <record id="warning_messaging_2" model="warning.messaging">
            <field name="name">Aviso presupuesto sin respuesta</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="function_name">_check_sale_period</field>
            <field name="body">[AVISO] Han pasado X dias desde env√≠o de presupuesto sin respuesta del cliente.</field>
            <field name="condition_ids" eval="[(6,0,[ref('warning_messaging.warning_condition_2')])]"/>
            <field name="action_ids" eval="[(6,0,[ref('warning_messaging.warning_action_1'), ref('warning_messaging.warning_action_2'), ref('warning_messaging.warning_action_3')])]"/>
        </record>
        <!-- Aviso presupuesto cancelado con ingresos altos esperados -->
        <record id="warning_messaging_3" model="warning.messaging">
            <field name="name">Aviso presupuesto cancelado con ingresos altos esperados</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="function_name">_check_sale_period</field>
            <field name="body">[AVISO] Cancelaron el presupuesto, pero el ingreso esperado es alto.</field>
            <field name="condition_ids" eval="[(6,0,[ref('warning_messaging.warning_condition_3')])]"/>
            <field name="action_ids" eval="[(6,0,[ref('warning_messaging.warning_action_4')])]"/>
        </record>


        <!-- EJEMPLOS -->
        <!-- Usuario test_user -->
        <record id="res_partner_0" model="res.partner">
            <field name="name">test_user</field>
            <field name="customer" eval="False"/>
            <field name="email">test_user@prueba.com</field>
        </record>
        <record id="res_users_0" model="res.users">
            <field name="name">test_user</field>
            <field name="login">test_user</field>
            <field name="password">a</field>
            <field name="groups_id" eval="[(6,0,[ref('base.group_sale_salesman_all_leads')])]"/>
            <field name="partner_id" ref="res_partner_0"/>
            <field name="active" eval="True"/>
        </record>

        <!-- Cliente prueba -->
        <record id="res_partner_1" model="res.partner">
            <field name="name">cliente prueba</field>
            <field name="customer" eval="True"/>
            <field name="email">prueba@prueba.com</field>
        </record>
        <!-- Presupuesto venta en borrador. Comercial: test_user-->
        <record id="sale_order_1" model="sale.order">
            <field name="partner_id" ref="res_partner_1"/>
            <field name="partner_invoice_id" ref="res_partner_1"/>
            <field name="partner_shipping_id" ref="res_partner_1"/>
            <field name="user_id" ref="res_users_0"/>
            <field name="pricelist_id" ref="product.list0"/>
            <field name="section_id" ref="sales_team.section_sales_department"/>
            <field name="date_order" eval="(DateTime.today() - relativedelta(months=1)).strftime('%Y-%m-%d %H:%M')"/>
        </record>
        <record id="sale_order_line_1" model="sale.order.line">
            <field name="order_id" ref="sale_order_1"/>
            <field name="name">Laptop E5023</field>
            <field name="product_uom_qty">1</field>
            <field name="product_uos_qty">1</field>
            <field name="price_unit">2950.00</field>
        </record>

        <!-- Presupuesto venta en borrador. Comercial: base.user_root-->
        <record id="sale_order_2" model="sale.order">
            <field name="partner_id" ref="res_partner_1"/>
            <field name="partner_invoice_id" ref="res_partner_1"/>
            <field name="partner_shipping_id" ref="res_partner_1"/>
            <field name="user_id" ref="base.user_root"/>
            <field name="pricelist_id" ref="product.list0"/>
            <field name="section_id" ref="sales_team.section_sales_department"/>
            <field name="date_order" eval="(DateTime.today() - relativedelta(months=1)).strftime('%Y-%m-%d %H:%M')"/>
        </record>
        <record id="sale_order_line_2" model="sale.order.line">
            <field name="order_id" ref="sale_order_2"/>
            <field name="name">PC AHF4521</field>
            <field name="product_uom_qty">1</field>
            <field name="product_uos_qty">1</field>
            <field name="price_unit">5007.00</field>
        </record>

        <!-- Oportunidad. Comercial: test_user-->
        <record id="crm_lead_1" model="crm.lead">
            <field name="name">Oportunidad 1</field>
            <field name="partner_id" ref="res_partner_1"/>
            <field name="email_from">prueba@prueba.com</field>
            <field name="user_id" ref="res_users_0"/>
            <field name="type">opportunity</field>
        </record>
        <!-- Oportunidad. Comercial: base.user_root-->
        <record id="crm_lead_2" model="crm.lead">
            <field name="name">Oportunidad 2</field>
            <field name="partner_id" ref="res_partner_1"/>
            <field name="email_from">prueba@prueba.com</field>
            <field name="user_id" ref="base.user_root"/>
            <field name="type">opportunity</field>
        </record>



    </data>
</openerp>

